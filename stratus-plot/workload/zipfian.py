from cProfile import label
import matplotlib.pyplot as plt
import numpy as np

SMALL_SIZE = 14
MEDIUM_SIZE = 20
BIGGER_SIZE = 20

plt.rc('font', size=20)          # controls default text sizes
plt.rc('axes', titlesize=20)     # fontsize of the axes title
plt.rc('axes', labelsize=MEDIUM_SIZE)    # fontsize of the x and y labels
plt.rc('xtick', labelsize=BIGGER_SIZE)    # fontsize of the tick labels
plt.rc('ytick', labelsize=BIGGER_SIZE)    # fontsize of the tick labels
plt.rc('legend', fontsize=SMALL_SIZE)    # legend fontsize

# s=1.01, v=10
data1_100 = [41201,37531,34123,31485,29420,27773,25527,24119,23052,21844,20654,19530,18682,17832,17189,16665,15528,15035,14653,14189,13684,13491,12778,12316,11927,11824,11241,11071,10731,10533,10131,9960,9720,9643,9453,8991,8955,8740,8479,8312,8101,7963,7754,7832,7712,7473,7173,7227,6915,6861,6801,6770,6479,6421,6475,6306,6121,6117,5862,5886,5756,5709,5558,5632,5460,5361,5314,5178,5217,5131,5099,5164,5009,4829,4834,4853,4626,4658,4453,4600,4439,4451,4419,4271,4268,4317,4268,4235,4070,4085,4126,3984,3989,3750,3828,3839,3799,3812,3733]

# s=1.01, v=1
data2_100 = [196116,97756,64886,48887,38326,32322,27867,23880,21445,19176,17581,15947,14693,14056,12789,12041,11196,10598,10065,9431,9208,8895,8334,7881,7652,7207,7098,6861,6582,6164,6185,6068,5775,5609,5448,5167,5119,4965,4926,4607,4602,4584,4385,4272,4250,4037,3952,3941,3891,3759,3699,3736,3695,3484,3408,3366,3332,3369,3180,3079,3077,3007,2892,2980,2923,2824,2822,2752,2746,2641,2619,2591,2562,2595,2557,2507,2480,2432,2341,2368,2282,2317,2341,2252,2191,2189,2137,2054,2048,2029,2053,2081,1939,2026,1995,2001,1927,1904,1813]

# s=1.01, v=10
data1_200 = [32625,29575,27383,24997,23062,21578,20658,19369,18039,16988,16223,15790,14889,14190,13560,13090,12497,11977,11633,11192,10883,10529,10342,9768,9384,9260,8819,8760,8605,8396,8014,7908,7921,7650,7154,7252,7065,6789,6669,6759,6354,6364,6141,6049,6068,5885,5769,5654,5604,5377,5375,5341,5128,5136,5093,5144,4984,4769,4662,4788,4633,4592,4431,4374,4382,4299,4187,4105,4160,4064,3989,3972,3851,3974,3868,3911,3783,3730,3675,3573,3503,3540,3594,3357,3409,3335,3297,3396,3264,3309,3213,3201,3131,3007,3052,3131,3048,3060,3021,2883,2980,2861,2861,2829,2818,2693,2689,2812,2686,2682,2730,2571,2602,2598,2533,2563,2577,2548,2484,2452,2422,2487,2346,2380,2380,2359,2363,2326,2327,2286,2311,2262,2301,2289,2310,2200,2210,2112,2157,2141,2096,2229,2154,2056,2051,2008,2027,2066,1934,1960,1970,2006,2004,1958,1877,1950,1935,1932,1887,1838,1898,1783,1816,1882,1833,1809,1869,1784,1833,1833,1810,1676,1766,1758,1717,1727,1707,1709,1765,1676,1662,1658,1701,1565,1581,1590,1572,1628,1572,1647,1506,1584,1620,1595,1557,1555,1537,1557,1432]

# s=1.01, v=1
data2_200 = [173292,86762,57688,42833,34603,28359,24246,21453,19078,17143,15391,14206,12954,12034,11410,10620,9985,9353,8874,8440,8337,7779,7264,7156,6789,6440,6245,6111,5624,5675,5439,5231,5015,5068,4859,4786,4618,4422,4191,4201,4208,3878,3902,3773,3746,3661,3635,3518,3454,3320,3168,3192,3237,3127,3104,3018,2932,2957,2780,2786,2758,2681,2557,2529,2660,2509,2478,2453,2486,2297,2320,2294,2260,2272,2294,2143,2198,2123,2100,2031,2141,1985,1980,1879,1986,1943,1920,1871,1876,1877,1815,1819,1801,1773,1808,1773,1786,1706,1662,1717,1643,1584,1626,1563,1562,1628,1632,1569,1501,1518,1479,1417,1481,1459,1435,1387,1359,1386,1353,1427,1409,1352,1365,1365,1241,1343,1302,1296,1249,1317,1286,1209,1224,1237,1232,1145,1183,1211,1221,1150,1198,1168,1214,1163,1142,1153,1148,1151,1107,1165,1050,1064,1080,1064,1074,1071,1011,1090,1037,1003,1039,1118,1011,1019,978,995,989,977,1023,972,891,914,945,900,953,903,900,921,955,874,918,924,872,873,867,900,919,902,884,853,904,856,871,820,830,867,785,789,850]

# s=1.01, v=10
data1_300 = [29010,26354,24342,22126,20716,19217,17944,17174,16411,15151,14450,13790,13055,12825,12036,11753,11126,10730,10424,9945,9628,9257,9034,8771,8491,8283,8008,7975,7662,7331,7029,6991,6856,6543,6543,6433,6308,6101,5999,5903,5736,5812,5691,5273,5397,5163,5156,4950,4877,4848,4899,4753,4500,4543,4523,4340,4326,4334,4127,4248,4118,4026,3968,3956,3819,3842,3726,3725,3635,3554,3674,3537,3605,3564,3534,3326,3284,3265,3228,3324,3216,3144,3128,3053,3011,3057,2924,2924,3018,2802,2773,2857,2786,2735,2814,2644,2735,2578,2666,2668,2647,2547,2677,2545,2529,2544,2449,2441,2374,2330,2444,2298,2411,2335,2237,2236,2258,2216,2153,2238,2274,2154,2168,2204,2114,2108,2159,2032,2023,1967,1981,2042,2099,1929,2057,2000,1992,1943,1908,1928,1939,1809,1871,1873,1906,1812,1798,1736,1719,1755,1848,1779,1730,1729,1720,1744,1761,1636,1644,1690,1663,1614,1633,1658,1685,1561,1663,1616,1581,1568,1541,1551,1635,1542,1468,1543,1454,1498,1505,1522,1508,1461,1491,1477,1460,1440,1455,1455,1395,1447,1473,1450,1453,1465,1378,1345,1430,1359,1312,1378,1327,1334,1294,1380,1358,1381,1341,1272,1301,1265,1270,1236,1277,1279,1266,1211,1199,1218,1200,1255,1252,1253,1220,1231,1217,1114,1233,1191,1206,1113,1236,1200,1112,1157,1118,1191,1106,1090,1142,1139,1136,1124,1126,1121,1162,1129,1107,1110,1109,1096,1107,1136,1057,1038,1062,1064,1078,1075,979,1084,1044,1039,1043,1094,1055,1028,1018,1006,1001,1019,1043,999,933,949,970,961,970,969,934,991,951,941,1038,925,906,950,969,983,944,974,914,982,925,941,907,931,916,828,937]

# s=1.01, v=1
data2_300 = [162332,81183,54223,40283,32148,27026,22702,19844,17816,15987,14653,13254,12358,11239,10718,9876,9269,8851,8380,7877,7597,7138,6883,6615,6316,6101,6077,5774,5368,5197,5237,4969,4801,4598,4487,4383,4294,4069,4021,3926,3890,3769,3542,3578,3583,3414,3480,3330,3257,3155,3072,2948,2990,2880,2934,2774,2690,2684,2629,2584,2601,2565,2480,2544,2365,2412,2341,2286,2165,2197,2202,2245,2116,2185,2113,2114,2043,1991,1993,2012,1855,1934,1853,1911,1820,1795,1744,1661,1756,1816,1738,1663,1660,1655,1657,1674,1549,1574,1535,1568,1509,1528,1503,1508,1565,1388,1491,1452,1437,1398,1384,1339,1412,1406,1362,1273,1344,1261,1286,1305,1255,1296,1288,1259,1213,1254,1211,1235,1187,1197,1216,1172,1180,1156,1202,1177,1157,1176,1172,1096,1104,1079,1116,1073,1027,1066,1069,1042,1010,1034,1028,1053,1056,1067,1000,1039,946,995,935,986,938,917,987,902,966,923,912,898,859,873,909,880,906,930,880,912,876,861,885,893,768,828,889,821,850,849,806,814,833,874,784,769,784,776,788,820,775,739,731,753,787,772,794,736,751,785,716,754,787,752,741,735,694,770,727,736,710,735,706,748,682,677,656,689,695,680,677,707,676,665,608,688,702,649,663,627,658,647,716,692,613,647,633,629,616,616,638,598,641,643,626,605,575,571,586,567,593,584,586,586,568,587,537,581,597,611,529,572,566,619,569,543,520,550,544,558,558,587,579,568,540,531,571,525,547,587,517,532,539,521,517,528,542,538,471,476,509,517,521]

# s=1.01, v=10
data1_400 = [26846,24504,22499,20662,19104,17773,16737,15670,15153,14305,13337,12825,12101,11553,11274,10956,10235,10077,9555,9272,8901,8718,8363,8121,7768,7637,7367,7380,6961,6932,6692,6659,6438,6237,5930,5803,5835,5533,5488,5428,5335,5283,5094,5101,4934,4808,4762,4694,4774,4526,4504,4264,4354,4182,4125,4105,3965,3911,3884,3893,3890,3743,3576,3691,3612,3484,3417,3430,3490,3329,3267,3321,3267,3167,3175,3095,3129,2990,3016,2969,2905,2931,2906,2815,2768,2865,2702,2827,2817,2768,2747,2604,2607,2485,2526,2456,2607,2504,2492,2456,2413,2350,2336,2345,2312,2274,2289,2262,2312,2169,2213,2068,2197,2120,2161,2082,2166,2005,2126,1970,1986,1999,2065,2026,2008,1923,1999,2036,1894,1968,1927,1850,1863,1866,1785,1789,1747,1871,1746,1768,1823,1760,1698,1648,1723,1675,1695,1642,1634,1674,1689,1666,1584,1628,1671,1634,1551,1575,1630,1525,1539,1511,1433,1526,1445,1542,1571,1486,1470,1516,1508,1473,1485,1447,1410,1377,1453,1445,1390,1354,1373,1414,1358,1395,1346,1324,1314,1282,1268,1298,1354,1328,1304,1278,1267,1265,1278,1281,1319,1248,1200,1215,1246,1214,1200,1199,1185,1233,1215,1183,1277,1139,1173,1244,1132,1180,1167,1121,1118,1131,1208,1132,1138,1079,1045,1150,1080,1081,1120,1056,1112,1086,1093,1068,1072,1094,1081,1057,1059,1013,1070,1065,1010,1060,1035,1060,1066,1047,1045,1033,1038,1000,1005,982,1030,979,948,972,997,958,968,951,934,957,1007,988,1007,940,971,919,936,886,933,898,896,931,893,926,890,895,891,849,856,902,852,878,927,887,900,859,884,883,871,852,801,864,876,846,882,814,810,889,821,854,793,813,824,799,870,802,779,750,795,829,810,839,762,827,792,790,825,804,807,788,754,816,793,788,775,777,852,748,719,704,800,745,748,753,758,788,723,696,763,726,755,712,758,715,817,739,698,747,714,696,713,727,693,730,750,689,657,672,684,672,676,681,683,641,686,672,686,726,635,677,687,711,646,620,679,654,677,684,685,684,664,676,622,680,697,628,669,628,637,653,665,589,591,636,649]

# s=1.01, v=1
data2_400 = [155462,77775,51874,38682,30736,25663,22113,18981,16828,15347,13963,12695,12028,10782,10111,9507,8901,8584,7870,7520,7272,6798,6677,6350,6100,5738,5644,5382,5177,5073,4880,4925,4707,4454,4265,4118,4230,3973,3926,3746,3657,3607,3452,3475,3325,3230,3170,3151,3019,3060,2945,2847,2772,2850,2810,2692,2669,2703,2571,2552,2465,2430,2356,2285,2271,2343,2224,2268,2133,2084,2128,2040,2019,1981,2041,2018,1934,1928,1904,1943,1825,1833,1878,1733,1744,1634,1711,1626,1728,1733,1610,1654,1706,1581,1593,1595,1546,1475,1550,1526,1475,1431,1456,1441,1428,1423,1381,1367,1324,1303,1262,1342,1380,1349,1300,1246,1281,1240,1252,1242,1276,1208,1174,1201,1170,1177,1148,1125,1137,1146,1175,1116,1184,1110,1062,1111,1122,1054,1069,1060,1044,1009,1014,1061,1078,995,1052,924,954,1007,962,949,956,987,961,950,952,949,913,917,958,923,901,908,914,866,900,901,870,865,885,884,875,886,868,868,865,865,859,814,819,801,827,837,791,811,731,796,803,773,768,751,774,740,766,791,788,780,773,765,755,736,704,709,730,689,746,677,681,689,722,681,703,701,666,691,668,667,623,634,670,675,623,658,691,663,656,678,646,644,642,642,645,643,615,578,594,653,644,589,618,660,570,584,581,675,577,641,562,574,575,580,579,558,565,626,550,581,520,525,563,552,567,577,560,589,525,532,585,546,528,556,560,559,542,560,521,558,508,501,569,533,536,515,532,546,511,539,540,514,451,509,459,517,486,516,494,486,497,495,499,515,465,449,484,483,519,452,491,494,448,479,470,459,513,526,461,461,434,504,453,449,441,467,428,481,436,417,478,446,473,451,444,425,408,411,431,416,413,428,401,431,426,417,408,411,428,403,399,417,427,435,437,380,394,422,421,426,429,390,398,384,374,409,386,407,409,389,411,415,409,425,371,395,398,421,383,368,389,424,404,369,365,402,393,360,357,394,380,389,388,362,343,338,344,370,384,372,375]

def do_plot():
    f, ax = plt.subplots(1,4, figsize=(14,4),sharey=True, frameon=False, constrained_layout=True)
    replicaNo1 = range(1,100)
    replicaNo2 = range(1,200)
    replicaNo3 = range(1,300)
    replicaNo4 = range(1,400)
    x1_100 = np.array(data1_100)
    x1_100 = x1_100/(x1_100.sum() * 1.0)
    x2_100 = np.array(data2_100)
    x2_100 = x2_100/(x2_100.sum() * 1.0)
    x1_200 = np.array(data1_200)
    x1_200 = x1_200/(x1_200.sum() * 1.0)
    x2_200 = np.array(data2_200)
    x2_200 = x2_200/(x2_200.sum() * 1.0)
    x1_300 = np.array(data1_300)
    x1_300 = x1_300/(x1_300.sum() * 1.0)
    x2_300 = np.array(data2_300)
    x2_300 = x2_300/(x2_300.sum() * 1.0)
    x1_400 = np.array(data1_400)
    x1_400 = x1_400/(x1_400.sum() * 1.0)
    x2_400 = np.array(data2_400)
    x2_400 = x2_400/(x2_400.sum() * 1.0)
    
    ax[0].plot(replicaNo1, x2_100/(x2_100.sum() * 1.0), color = 'indianred', label='Zipf')
    ax[0].plot(replicaNo1, x1_100/(x1_100.sum() * 1.0), linestyle = 'dashed', label='Zipf')
    ax[1].plot(replicaNo2, x2_200/(x2_200.sum() * 1.0), color = 'indianred')
    ax[1].plot(replicaNo2, x1_200/(x1_200.sum() * 1.0), linestyle = 'dashed')
    ax[2].plot(replicaNo3, x2_300/(x2_300.sum() * 1.0), color = 'indianred')
    ax[2].plot(replicaNo3, x1_300/(x1_300.sum() * 1.0), linestyle = 'dashed')
    ax[3].plot(replicaNo4, x2_400/(x2_400.sum() * 1.0), color = 'indianred', label='Zipf1')
    ax[3].plot(replicaNo4, x1_400/(x1_400.sum() * 1.0), linestyle = 'dashed', label='Zipf10')
    ax[0].set_title("(a) 100 replicas")
    ax[1].set_title("(b) 200 replicas")
    ax[2].set_title("(c) 300 replicas")
    ax[3].set_title("(d) 400 replicas")

    ax[0].annotate(str(round(x1_100[0],3)), xy=(1, x1_100[0]), xytext=(30, 0.04),
         arrowprops=dict(facecolor='black', arrowstyle='->'))
    ax[0].annotate(str(round(x2_100[0],3)), xy=(1, x2_100[0]), xytext=(30, 0.15),
         arrowprops=dict(facecolor='black', arrowstyle='->'))
    ax[1].annotate(str(round(x1_200[0],3)), xy=(1, x1_200[0]), xytext=(60, 0.04),
         arrowprops=dict(facecolor='black', arrowstyle='->'))
    ax[1].annotate(str(round(x2_200[0],3)), xy=(1, x2_200[0]), xytext=(60, 0.15),
         arrowprops=dict(facecolor='black', arrowstyle='->'))
    ax[2].annotate(str(round(x1_300[0],3)), xy=(1, x1_300[0]), xytext=(90, 0.04),
         arrowprops=dict(facecolor='black', arrowstyle='->'))
    ax[2].annotate(str(round(x2_300[0],3)), xy=(1, x2_300[0]), xytext=(90, 0.15),
         arrowprops=dict(facecolor='black', arrowstyle='->'))
    ax[3].annotate(str(round(x1_400[0],3)), xy=(1, x1_400[0]), xytext=(120, 0.04),
         arrowprops=dict(facecolor='black', arrowstyle='->'))
    ax[3].annotate(str(round(x2_400[0],3)), xy=(1, x2_400[0]), xytext=(120, 0.14),
            arrowprops=dict(facecolor='black', arrowstyle='->'))
    # ax[0][0].set_ylabel("Workload distribution")
    ax[0].set_ylim([0,0.24])
    ax[2].set_xticks([0, 150, 300])
    # ax[0].set_xlim([-5,100])
    # ax[1].set_xlim([-5,200])
    # ax[2].set_xlim([-5,300])
    # ax[3].set_xlim([-5,400])
    # ax[1].set_ylim([0,0.2])
    # ax[1].set_ylim([0,0.2])
    # ax[0].set_ylim([0,0.2])
    # plt.subplots_adjust(wspace=0.15)
    # plt.tight_layout()
    # plt.subplots_adjust(hspace=0.3)
    f.supxlabel("Replica ID")
    # plt.xlabel("Replica ID")
    f.supylabel("Load distribution")
    # ax[0].legend(loc='best', fancybox=True,frameon=False,framealpha=0.3,ncol=2,bbox_to_anchor=(1, 1))
    # plt.plot(replicaNo1, x2_100/(x2_100.sum() * 1.0), color = 'indianred', label='Zipf s=1.01, v=1')
    plt.legend(loc='upper right', fancybox=True,framealpha=0.3,ncol=1)
    plt.savefig('zipfian.pdf', format='pdf')
    plt.show()

if __name__ == '__main__':
    do_plot()
